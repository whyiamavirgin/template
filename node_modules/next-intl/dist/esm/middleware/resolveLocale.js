import{match as e}from"@formatjs/intl-localematcher";import o from"negotiator";import{COOKIE_LOCALE_NAME as l}from"../shared/constants.js";import{getPathnameMatch as t,isLocaleSupportedOnDomain as a,getHost as n}from"./utils.js";function c(l,t,a){let n;const c=new o({headers:{"accept-language":l.get("accept-language")||void 0}}).languages();try{n=e(c,t,a)}catch(e){}return n}function i(e,o){if(e.has(l)){var t;const a=null===(t=e.get(l))||void 0===t?void 0:t.value;if(a&&o.includes(a))return a}}function r(e,o,l,a){let n,{defaultLocale:r,localeDetection:u,localePrefix:f,locales:s}=e;var d;a&&(n=null===(d=t(a,s,f))||void 0===d?void 0:d.locale);return!n&&u&&l&&(n=i(l,s)),!n&&u&&o&&(n=c(o,s,r)),n||(n=r),n}function u(e,o,l,u){const f=function(e,o){var l;let t=n(e);if(t=null===(l=t)||void 0===l?void 0:l.replace(/:\d+$/,""),t&&o)return o.find((e=>e.domain===t))}(o,e.domains);if(!f)return{locale:r(e,o,l,u)};let s;if(u){var d;const o=null===(d=t(u,e.locales,e.localePrefix))||void 0===d?void 0:d.locale;if(o){if(!a(o,f))return{locale:o,domain:f};s=o}}if(!s&&e.localeDetection&&l){const o=i(l,e.locales);o&&a(o,f)&&(s=o)}if(!s&&e.localeDetection&&o){const l=c(o,f.locales||e.locales,f.defaultLocale);l&&(s=l)}return s||(s=f.defaultLocale),{locale:s,domain:f}}function f(e,o,l,t){return e.domains?u(e,o,l,t):{locale:r(e,o,l,t)}}export{f as default,c as getAcceptLanguageLocale};
